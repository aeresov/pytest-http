{
    "stages": [
        {
            "name": "get_users_with_functions",
            "url": "https://jsonplaceholder.typicode.com/users",
            "params": {
                "limit": 5
            },
            "headers": {
                "Accept": "application/json",
                "User-Agent": "pytest-http/0.1.0"
            },
            "save": {
                "vars": {
                    "user_count": "length(@)",
                    "first_user_id": "[0].id"
                },
                "functions": ["extract_user_metadata", "extract_response_info"]
            }
        },
        {
            "name": "use_extracted_variables",
            "url": "https://jsonplaceholder.typicode.com/users/$first_user_id",
            "headers": {
                "Accept": "application/json"
            },
            "save": {
                "vars": {
                    "user_email": "json.email",
                    "user_website": "json.website"
                }
            }
        }
    ]
}