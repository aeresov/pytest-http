{
    "fixtures": [
        "expected_status",
        "expected_text",
        "field_path"
    ],
    "stages": [
        {
            "name": "test_verify_functions_with_kwargs_basic",
            "url": "https://httpbin.org/json",
            "verify": {
                "status": 200,
                "functions": [
                    {
                        "function": "test_kwargs_helpers:verify_response_status_custom",
                        "kwargs": {
                            "expected_status": 200
                        }
                    }
                ]
            }
        },
        {
            "name": "test_verify_functions_with_kwargs_text",
            "url": "https://httpbin.org/json",
            "verify": {
                "functions": [
                    {
                        "function": "test_kwargs_helpers:verify_response_contains_text",
                        "kwargs": {
                            "expected_text": "Sample Slide Show",
                            "case_sensitive": false
                        }
                    }
                ]
            }
        },
        {
            "name": "test_verify_functions_with_kwargs_header",
            "url": "https://httpbin.org/headers",
            "verify": {
                "functions": [
                    {
                        "function": "test_kwargs_helpers:verify_response_header_value",
                        "kwargs": {
                            "header_name": "content-type",
                            "expected_value": "application/json"
                        }
                    }
                ]
            }
        },
        {
            "name": "test_verify_functions_with_kwargs_json",
            "url": "https://httpbin.org/json",
            "verify": {
                "functions": [
                    {
                        "function": "test_kwargs_helpers:verify_response_json_field",
                        "kwargs": {
                            "field_path": "slideshow.title",
                            "expected_value": "Sample Slide Show"
                        }
                    }
                ]
            }
        },
        {
            "name": "test_verify_functions_mixed_format",
            "url": "https://httpbin.org/json",
            "verify": {
                "status": 200,
                "functions": [
                    "test_kwargs_helpers:verify_response_has_json",
                    {
                        "function": "test_kwargs_helpers:verify_response_json_field",
                        "kwargs": {
                            "field_path": "slideshow.author",
                            "expected_value": "Yours Truly"
                        }
                    }
                ]
            }
        },
        {
            "name": "test_functions_with_kwargs_basic",
            "url": "https://httpbin.org/json",
            "save": {
                "vars": {
                    "test_var": "json.slideshow.title"
                },
                "functions": [
                    {
                        "function": "test_kwargs_helpers:extract_custom_data",
                        "kwargs": {
                            "field_path": "slideshow.author",
                            "default_value": "unknown_author"
                        }
                    }
                ]
            }
        },
        {
            "name": "test_functions_with_kwargs_multiple_fields",
            "url": "https://httpbin.org/json",
            "save": {
                "functions": [
                    {
                        "function": "test_kwargs_helpers:extract_multiple_fields",
                        "kwargs": {
                            "fields": ["slideshow.title", "slideshow.author", "slideshow.date"]
                        }
                    }
                ]
            }
        },
        {
            "name": "test_functions_with_kwargs_filter",
            "url": "https://httpbin.org/json",
            "save": {
                "functions": [
                    {
                        "function": "test_kwargs_helpers:extract_with_filter",
                        "kwargs": {
                            "field_path": "slideshow.slides",
                            "filter_field": "type",
                            "filter_value": "all"
                        }
                    }
                ]
            }
        },
        {
            "name": "test_functions_mixed_format",
            "url": "https://httpbin.org/json",
            "save": {
                "vars": {
                    "test_var": "json.slideshow.title"
                },
                "functions": [
                    "test_kwargs_helpers:extract_test_data",
                    {
                        "function": "test_kwargs_helpers:extract_custom_data",
                        "kwargs": {
                            "field_path": "slideshow.author",
                            "default_value": "custom_author"
                        }
                    }
                ]
            }
        },
        {
            "name": "test_kwargs_with_fixtures",
            "url": "https://httpbin.org/json",
            "verify": {
                "functions": [
                    {
                        "function": "test_kwargs_helpers:verify_response_status_custom",
                        "kwargs": {
                            "expected_status": "$expected_status"
                        }
                    },
                    {
                        "function": "test_kwargs_helpers:verify_response_contains_text",
                        "kwargs": {
                            "expected_text": "$expected_text",
                            "case_sensitive": false
                        }
                    }
                ]
            }
        },
        {
            "name": "test_kwargs_with_saved_variables",
            "url": "https://httpbin.org/json",
            "save": {
                "vars": {
                    "extracted_title": "json.slideshow.title",
                    "extracted_author": "json.slideshow.author"
                },
                "functions": [
                    {
                        "function": "test_kwargs_helpers:extract_custom_data",
                        "kwargs": {
                            "field_path": "$field_path",
                            "default_value": "unknown"
                        }
                    }
                ]
            },
            "verify": {
                "functions": [
                    {
                        "function": "test_kwargs_helpers:verify_response_json_field",
                        "kwargs": {
                            "field_path": "slideshow.title",
                            "expected_value": "$extracted_title"
                        }
                    },
                    {
                        "function": "test_kwargs_helpers:verify_response_contains_text",
                        "kwargs": {
                            "expected_text": "$extracted_author",
                            "case_sensitive": true
                        }
                    }
                ]
            }
        },
        {
            "name": "test_kwargs_with_mixed_variables",
            "url": "https://httpbin.org/json",
            "save": {
                "vars": {
                    "slide_count": "json.slideshow.slides.length()"
                },
                "functions": [
                    {
                        "function": "test_kwargs_helpers:extract_multiple_fields",
                        "kwargs": {
                            "fields": ["$field_path", "slideshow.author", "slideshow.date"]
                        }
                    }
                ]
            },
            "verify": {
                "functions": [
                    {
                        "function": "test_kwargs_helpers:verify_response_json_field",
                        "kwargs": {
                            "field_path": "slideshow.slides.length()",
                            "expected_value": "$slide_count"
                        }
                    }
                ]
            }
        },
        {
            "name": "test_kwargs_with_same_stage_variables",
            "url": "https://httpbin.org/json",
            "save": {
                "vars": {
                    "title": "json.slideshow.title"
                },
                "functions": [
                    {
                        "function": "test_kwargs_helpers:extract_custom_data",
                        "kwargs": {
                            "field_path": "slideshow.author",
                            "default_value": "$title"
                        }
                    }
                ]
            },
            "verify": {
                "functions": [
                    {
                        "function": "test_kwargs_helpers:verify_response_contains_text",
                        "kwargs": {
                            "expected_text": "$title",
                            "case_sensitive": false
                        }
                    }
                ]
            }
        }
    ]
}